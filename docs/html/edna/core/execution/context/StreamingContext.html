<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.1" />
<title>edna.core.execution.context.StreamingContext API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>edna.core.execution.context.StreamingContext</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">from __future__ import annotations
from edna.core.plans.executiongraph import ExecutionGraph
from typing import Dict

from edna.api import DataStream

from edna.core.execution.context import EdnaContext
from edna.core.configuration import StreamingConfiguration

from edna.core.plans.streamgraph import StreamGraph
from edna.core.plans.streamgraph import StreamGraphFlattener

from edna.core.plans.physicalgraph import PhysicalGraph
from edna.core.plans.physicalgraph import PhysicalGraphBuilder


class StreamingContext(EdnaContext):
    streaming_node_id : int = -1 # Running count of stream node ids
    physical_node_id : int = -1 # Running count of physical node ids
    datastream_id : int = -1 # Running count of streams
    stream_collection : Dict[int, DataStream] = {}
    stream_graph: StreamGraph = None

    logical_stream_graph : StreamGraph
    physical_graph : PhysicalGraph
    # physical_stream_graph
    # execution_graph

    def __init__(self, dir : str = &#34;.&#34;, confpath : str = &#34;ednaconf.yaml&#34;, confclass: StreamingConfiguration = StreamingConfiguration):
        super().__init__(dir=dir, confpath=confpath, confclass=confclass, logger=&#34;StreamingContext&#34;)

        self.streaming_node_id = -1
        self.physical_node_id = -1
        self.datastream_id = -1
        self.stream_collection = {}
        self.stream_graph = None
        self.logger.info(&#34;Initialized the Streaming Context&#34;)


    def getNewStreamingNodeId(self):
        self.streaming_node_id += 1
        self.logger.debug(&#34;New streamgraph node id requested: {streaming_node_id}&#34;.format(streaming_node_id=self.streaming_node_id))
        return self.streaming_node_id
    
    def getDatastreamId(self):
        self.datastream_id += 1
        self.logger.debug(&#34;New datastream id requested: {datastream_id}&#34;.format(datastream_id=self.datastream_id))
        return self.datastream_id

    def getNewPhysicalNodeId(self):
        self.physical_node_id += 1
        self.logger.debug(&#34;New physical node id requested: {physical_node_id}&#34;.format(physical_node_id=self.physical_node_id))
        return self.physical_node_id

    def addStream(self, stream: DataStream):
        if not stream.verifyStreamGraph():
            # TODO handle wanring
            self.logger.warn(&#34;Stream graph might not be valid. Probably because SplitStream has Nones&#34;)
        if stream.getStreamId() in self.stream_collection:
            # TODO log to error?
            raise RuntimeError(&#34;Stream already exists in current context.&#34;)
        self.logger.info(&#34;Adding new stream to context with stream name {stream_name} and stream id {stream_id}&#34;
            .format(stream_name=stream.getStreamName(), 
                    stream_id=stream.getStreamId()))
        self.stream_collection[stream.getStreamId()] = stream

    
    def run(self):
        &#34;&#34;&#34;Steps:

        1. First flatten the streams
        2. Then convert the streamgraph to a physicalgraph
        3. Then convert the physicalgraph to an executiongraph, and start an executioncontext
        4. Execute the executioncontext (I Guess)
        &#34;&#34;&#34;
        
        self.logger.info(&#34;Starting context execution&#34;)
        #pdb.set_trace()

        self.logger.info(&#34;Flattening streams to StreamGraph&#34;)
        self.logical_stream_graph = self.flattenStream()
        # TODO we need to delete the old stream graphs
        # Also, need to make sure when we add the stream nodes to the flattened stream, we pass by reference and only delete
        #     the collection of streams, not the actual nodes.
        #     TODO TODO Also, need to adjust the initialization functions of each node so that it does lazy initialization!!!!
        self.logger.info(&#34;Flattened {num_streams} into single stream&#34;.format(num_streams=len(self.stream_collection)))
        #pdb.set_trace()

        
        self.logger.info(&#34;Converting StreamGraph to PhysicalGraph&#34;)
        self.physical_graph = self.buildPhysicalGraph()
        self.logger.info(&#34;Converted StreamGraph with {num_nodes} nodes to PhysicalGraph with {num_phys} PhysicalNodes&#34;.format(
            num_nodes=len(self.logical_stream_graph.node_list),
            num_phys = len(self.physical_graph.physical_node_list)
        ))
        #pdb.set_trace()

        self.execution_context = ExecutionGraph()
        self.logger.info(&#34;Converting PhysicalGraph to ExecutionGraph&#34;)
        self.execution_context.buildExecutionGraph(self.physical_graph)
        #pdb.set_trace()

        self.logger.info(&#34;Executing the context&#34;)
        self.execution_context.execute()
        self.logger.info(&#34;Finished executing context&#34;)
        

        # TODO
        # Then convert to physical graph
        # Convert the chained nodes that are 1-1 into a single node (we will deal with specifics later)
        # Add buffer nodes between single nodes -- basically replace each edge with a write buffer and a read buffer.
        # A write buffer and a read buffer next to each other have the same port

        # Physical graph conversion -- take all edges where the source and target are process nodes and source is a MAP process
            # replace with a ChainedProcess, which is a BaseProcess that takes an outer and inner, and does outer(inner())
            # Also need to handle ingest-process pairs, and process-emit pairs
            # Then we need to handle serializers serializers

        
        # So we will use breadth first.
        # We need a PhysicalPrimitive.


    def flattenStream(self) -&gt; StreamGraph:
        &#34;&#34;&#34;flattenStream() will combine all the stream graphs into a single graph
        TODO when we add SplitStreamOperator, we will need to update this flattenStream()
        &#34;&#34;&#34;
        return StreamGraphFlattener.flattenStream(self.stream_collection)

        
        # First add each node to the flattenedStreamGraph
    
    def buildPhysicalGraph(self) -&gt; PhysicalGraph:
        return PhysicalGraphBuilder.convertStreamGraph(self)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="edna.core.execution.context.StreamingContext.StreamingContext"><code class="flex name class">
<span>class <span class="ident">StreamingContext</span></span>
<span>(</span><span>dir: str = '.', confpath: str = 'ednaconf.yaml', confclass: StreamingConfiguration = edna.core.configuration.StreamingConfiguration.StreamingConfiguration)</span>
</code></dt>
<dd>
<div class="desc"><p>An EdnaContext is the generic context for any EdnaJob. It is an interface for the SimpleStreamingContext and other future contexts.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>configuration</code></strong> :&ensp;<code>EdnaConfiguration</code></dt>
<dd>Stores a EdnaConfiguration object to control the job configuration.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>PrimitiveNotSetException</code></dt>
<dd>Raises this exception if <code>execute()</code> is called without setting all of the primitives.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>EdnaContext</code></dt>
<dd>Returns an EdnaContext.</dd>
</dl>
<p>Initializes the EdnaContext with a directory, configuration file, and configuratioon object. </p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>dir</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The directory for the job configuration. Defaults to the current directory "."</dd>
<dt><strong><code>confpath</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>A YAML configuration file for the job. Job variables are loaded as top-level
fields from this file. Defaults to "ednaconf.yaml".</dd>
<dt><strong><code>confclass</code></strong> :&ensp;<code>EdnaConfiguration</code>, optional</dt>
<dd>Object to store and interact with the Configuration.
Defaults to edna.core.configuration.StreamingConfiguration.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class StreamingContext(EdnaContext):
    streaming_node_id : int = -1 # Running count of stream node ids
    physical_node_id : int = -1 # Running count of physical node ids
    datastream_id : int = -1 # Running count of streams
    stream_collection : Dict[int, DataStream] = {}
    stream_graph: StreamGraph = None

    logical_stream_graph : StreamGraph
    physical_graph : PhysicalGraph
    # physical_stream_graph
    # execution_graph

    def __init__(self, dir : str = &#34;.&#34;, confpath : str = &#34;ednaconf.yaml&#34;, confclass: StreamingConfiguration = StreamingConfiguration):
        super().__init__(dir=dir, confpath=confpath, confclass=confclass, logger=&#34;StreamingContext&#34;)

        self.streaming_node_id = -1
        self.physical_node_id = -1
        self.datastream_id = -1
        self.stream_collection = {}
        self.stream_graph = None
        self.logger.info(&#34;Initialized the Streaming Context&#34;)


    def getNewStreamingNodeId(self):
        self.streaming_node_id += 1
        self.logger.debug(&#34;New streamgraph node id requested: {streaming_node_id}&#34;.format(streaming_node_id=self.streaming_node_id))
        return self.streaming_node_id
    
    def getDatastreamId(self):
        self.datastream_id += 1
        self.logger.debug(&#34;New datastream id requested: {datastream_id}&#34;.format(datastream_id=self.datastream_id))
        return self.datastream_id

    def getNewPhysicalNodeId(self):
        self.physical_node_id += 1
        self.logger.debug(&#34;New physical node id requested: {physical_node_id}&#34;.format(physical_node_id=self.physical_node_id))
        return self.physical_node_id

    def addStream(self, stream: DataStream):
        if not stream.verifyStreamGraph():
            # TODO handle wanring
            self.logger.warn(&#34;Stream graph might not be valid. Probably because SplitStream has Nones&#34;)
        if stream.getStreamId() in self.stream_collection:
            # TODO log to error?
            raise RuntimeError(&#34;Stream already exists in current context.&#34;)
        self.logger.info(&#34;Adding new stream to context with stream name {stream_name} and stream id {stream_id}&#34;
            .format(stream_name=stream.getStreamName(), 
                    stream_id=stream.getStreamId()))
        self.stream_collection[stream.getStreamId()] = stream

    
    def run(self):
        &#34;&#34;&#34;Steps:

        1. First flatten the streams
        2. Then convert the streamgraph to a physicalgraph
        3. Then convert the physicalgraph to an executiongraph, and start an executioncontext
        4. Execute the executioncontext (I Guess)
        &#34;&#34;&#34;
        
        self.logger.info(&#34;Starting context execution&#34;)
        #pdb.set_trace()

        self.logger.info(&#34;Flattening streams to StreamGraph&#34;)
        self.logical_stream_graph = self.flattenStream()
        # TODO we need to delete the old stream graphs
        # Also, need to make sure when we add the stream nodes to the flattened stream, we pass by reference and only delete
        #     the collection of streams, not the actual nodes.
        #     TODO TODO Also, need to adjust the initialization functions of each node so that it does lazy initialization!!!!
        self.logger.info(&#34;Flattened {num_streams} into single stream&#34;.format(num_streams=len(self.stream_collection)))
        #pdb.set_trace()

        
        self.logger.info(&#34;Converting StreamGraph to PhysicalGraph&#34;)
        self.physical_graph = self.buildPhysicalGraph()
        self.logger.info(&#34;Converted StreamGraph with {num_nodes} nodes to PhysicalGraph with {num_phys} PhysicalNodes&#34;.format(
            num_nodes=len(self.logical_stream_graph.node_list),
            num_phys = len(self.physical_graph.physical_node_list)
        ))
        #pdb.set_trace()

        self.execution_context = ExecutionGraph()
        self.logger.info(&#34;Converting PhysicalGraph to ExecutionGraph&#34;)
        self.execution_context.buildExecutionGraph(self.physical_graph)
        #pdb.set_trace()

        self.logger.info(&#34;Executing the context&#34;)
        self.execution_context.execute()
        self.logger.info(&#34;Finished executing context&#34;)
        

        # TODO
        # Then convert to physical graph
        # Convert the chained nodes that are 1-1 into a single node (we will deal with specifics later)
        # Add buffer nodes between single nodes -- basically replace each edge with a write buffer and a read buffer.
        # A write buffer and a read buffer next to each other have the same port

        # Physical graph conversion -- take all edges where the source and target are process nodes and source is a MAP process
            # replace with a ChainedProcess, which is a BaseProcess that takes an outer and inner, and does outer(inner())
            # Also need to handle ingest-process pairs, and process-emit pairs
            # Then we need to handle serializers serializers

        
        # So we will use breadth first.
        # We need a PhysicalPrimitive.


    def flattenStream(self) -&gt; StreamGraph:
        &#34;&#34;&#34;flattenStream() will combine all the stream graphs into a single graph
        TODO when we add SplitStreamOperator, we will need to update this flattenStream()
        &#34;&#34;&#34;
        return StreamGraphFlattener.flattenStream(self.stream_collection)

        
        # First add each node to the flattenedStreamGraph
    
    def buildPhysicalGraph(self) -&gt; PhysicalGraph:
        return PhysicalGraphBuilder.convertStreamGraph(self)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="edna.core.execution.context.EdnaContext" href="index.html#edna.core.execution.context.EdnaContext">EdnaContext</a></li>
<li>abc.ABC</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="edna.core.execution.context.StreamingContext.StreamingContext.datastream_id"><code class="name">var <span class="ident">datastream_id</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="edna.core.execution.context.StreamingContext.StreamingContext.logical_stream_graph"><code class="name">var <span class="ident">logical_stream_graph</span> : StreamGraph</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="edna.core.execution.context.StreamingContext.StreamingContext.physical_graph"><code class="name">var <span class="ident">physical_graph</span> : PhysicalGraph</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="edna.core.execution.context.StreamingContext.StreamingContext.physical_node_id"><code class="name">var <span class="ident">physical_node_id</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="edna.core.execution.context.StreamingContext.StreamingContext.stream_collection"><code class="name">var <span class="ident">stream_collection</span> : Dict[int, DataStream]</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="edna.core.execution.context.StreamingContext.StreamingContext.stream_graph"><code class="name">var <span class="ident">stream_graph</span> : StreamGraph</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="edna.core.execution.context.StreamingContext.StreamingContext.streaming_node_id"><code class="name">var <span class="ident">streaming_node_id</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="edna.core.execution.context.StreamingContext.StreamingContext.addStream"><code class="name flex">
<span>def <span class="ident">addStream</span></span>(<span>self, stream: DataStream)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def addStream(self, stream: DataStream):
    if not stream.verifyStreamGraph():
        # TODO handle wanring
        self.logger.warn(&#34;Stream graph might not be valid. Probably because SplitStream has Nones&#34;)
    if stream.getStreamId() in self.stream_collection:
        # TODO log to error?
        raise RuntimeError(&#34;Stream already exists in current context.&#34;)
    self.logger.info(&#34;Adding new stream to context with stream name {stream_name} and stream id {stream_id}&#34;
        .format(stream_name=stream.getStreamName(), 
                stream_id=stream.getStreamId()))
    self.stream_collection[stream.getStreamId()] = stream</code></pre>
</details>
</dd>
<dt id="edna.core.execution.context.StreamingContext.StreamingContext.buildPhysicalGraph"><code class="name flex">
<span>def <span class="ident">buildPhysicalGraph</span></span>(<span>self) ‑> <a title="edna.core.plans.physicalgraph.PhysicalGraph.PhysicalGraph" href="../../plans/physicalgraph/PhysicalGraph.html#edna.core.plans.physicalgraph.PhysicalGraph.PhysicalGraph">PhysicalGraph</a></span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def buildPhysicalGraph(self) -&gt; PhysicalGraph:
    return PhysicalGraphBuilder.convertStreamGraph(self)</code></pre>
</details>
</dd>
<dt id="edna.core.execution.context.StreamingContext.StreamingContext.flattenStream"><code class="name flex">
<span>def <span class="ident">flattenStream</span></span>(<span>self) ‑> <a title="edna.core.plans.streamgraph.StreamGraph.StreamGraph" href="../../plans/streamgraph/StreamGraph.html#edna.core.plans.streamgraph.StreamGraph.StreamGraph">StreamGraph</a></span>
</code></dt>
<dd>
<div class="desc"><p>flattenStream() will combine all the stream graphs into a single graph
TODO when we add SplitStreamOperator, we will need to update this flattenStream()</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def flattenStream(self) -&gt; StreamGraph:
    &#34;&#34;&#34;flattenStream() will combine all the stream graphs into a single graph
    TODO when we add SplitStreamOperator, we will need to update this flattenStream()
    &#34;&#34;&#34;
    return StreamGraphFlattener.flattenStream(self.stream_collection)</code></pre>
</details>
</dd>
<dt id="edna.core.execution.context.StreamingContext.StreamingContext.getDatastreamId"><code class="name flex">
<span>def <span class="ident">getDatastreamId</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def getDatastreamId(self):
    self.datastream_id += 1
    self.logger.debug(&#34;New datastream id requested: {datastream_id}&#34;.format(datastream_id=self.datastream_id))
    return self.datastream_id</code></pre>
</details>
</dd>
<dt id="edna.core.execution.context.StreamingContext.StreamingContext.getNewPhysicalNodeId"><code class="name flex">
<span>def <span class="ident">getNewPhysicalNodeId</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def getNewPhysicalNodeId(self):
    self.physical_node_id += 1
    self.logger.debug(&#34;New physical node id requested: {physical_node_id}&#34;.format(physical_node_id=self.physical_node_id))
    return self.physical_node_id</code></pre>
</details>
</dd>
<dt id="edna.core.execution.context.StreamingContext.StreamingContext.getNewStreamingNodeId"><code class="name flex">
<span>def <span class="ident">getNewStreamingNodeId</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def getNewStreamingNodeId(self):
    self.streaming_node_id += 1
    self.logger.debug(&#34;New streamgraph node id requested: {streaming_node_id}&#34;.format(streaming_node_id=self.streaming_node_id))
    return self.streaming_node_id</code></pre>
</details>
</dd>
<dt id="edna.core.execution.context.StreamingContext.StreamingContext.run"><code class="name flex">
<span>def <span class="ident">run</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Steps:</p>
<ol>
<li>First flatten the streams</li>
<li>Then convert the streamgraph to a physicalgraph</li>
<li>Then convert the physicalgraph to an executiongraph, and start an executioncontext</li>
<li>Execute the executioncontext (I Guess)</li>
</ol></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def run(self):
    &#34;&#34;&#34;Steps:

    1. First flatten the streams
    2. Then convert the streamgraph to a physicalgraph
    3. Then convert the physicalgraph to an executiongraph, and start an executioncontext
    4. Execute the executioncontext (I Guess)
    &#34;&#34;&#34;
    
    self.logger.info(&#34;Starting context execution&#34;)
    #pdb.set_trace()

    self.logger.info(&#34;Flattening streams to StreamGraph&#34;)
    self.logical_stream_graph = self.flattenStream()
    # TODO we need to delete the old stream graphs
    # Also, need to make sure when we add the stream nodes to the flattened stream, we pass by reference and only delete
    #     the collection of streams, not the actual nodes.
    #     TODO TODO Also, need to adjust the initialization functions of each node so that it does lazy initialization!!!!
    self.logger.info(&#34;Flattened {num_streams} into single stream&#34;.format(num_streams=len(self.stream_collection)))
    #pdb.set_trace()

    
    self.logger.info(&#34;Converting StreamGraph to PhysicalGraph&#34;)
    self.physical_graph = self.buildPhysicalGraph()
    self.logger.info(&#34;Converted StreamGraph with {num_nodes} nodes to PhysicalGraph with {num_phys} PhysicalNodes&#34;.format(
        num_nodes=len(self.logical_stream_graph.node_list),
        num_phys = len(self.physical_graph.physical_node_list)
    ))
    #pdb.set_trace()

    self.execution_context = ExecutionGraph()
    self.logger.info(&#34;Converting PhysicalGraph to ExecutionGraph&#34;)
    self.execution_context.buildExecutionGraph(self.physical_graph)
    #pdb.set_trace()

    self.logger.info(&#34;Executing the context&#34;)
    self.execution_context.execute()
    self.logger.info(&#34;Finished executing context&#34;)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="edna.core.execution.context.EdnaContext" href="index.html#edna.core.execution.context.EdnaContext">EdnaContext</a></b></code>:
<ul class="hlist">
<li><code><a title="edna.core.execution.context.EdnaContext.execute" href="index.html#edna.core.execution.context.EdnaContext.execute">execute</a></code></li>
<li><code><a title="edna.core.execution.context.EdnaContext.getVariable" href="index.html#edna.core.execution.context.EdnaContext.getVariable">getVariable</a></code></li>
</ul>
</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="edna.core.execution.context" href="index.html">edna.core.execution.context</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="edna.core.execution.context.StreamingContext.StreamingContext" href="#edna.core.execution.context.StreamingContext.StreamingContext">StreamingContext</a></code></h4>
<ul class="">
<li><code><a title="edna.core.execution.context.StreamingContext.StreamingContext.addStream" href="#edna.core.execution.context.StreamingContext.StreamingContext.addStream">addStream</a></code></li>
<li><code><a title="edna.core.execution.context.StreamingContext.StreamingContext.buildPhysicalGraph" href="#edna.core.execution.context.StreamingContext.StreamingContext.buildPhysicalGraph">buildPhysicalGraph</a></code></li>
<li><code><a title="edna.core.execution.context.StreamingContext.StreamingContext.datastream_id" href="#edna.core.execution.context.StreamingContext.StreamingContext.datastream_id">datastream_id</a></code></li>
<li><code><a title="edna.core.execution.context.StreamingContext.StreamingContext.flattenStream" href="#edna.core.execution.context.StreamingContext.StreamingContext.flattenStream">flattenStream</a></code></li>
<li><code><a title="edna.core.execution.context.StreamingContext.StreamingContext.getDatastreamId" href="#edna.core.execution.context.StreamingContext.StreamingContext.getDatastreamId">getDatastreamId</a></code></li>
<li><code><a title="edna.core.execution.context.StreamingContext.StreamingContext.getNewPhysicalNodeId" href="#edna.core.execution.context.StreamingContext.StreamingContext.getNewPhysicalNodeId">getNewPhysicalNodeId</a></code></li>
<li><code><a title="edna.core.execution.context.StreamingContext.StreamingContext.getNewStreamingNodeId" href="#edna.core.execution.context.StreamingContext.StreamingContext.getNewStreamingNodeId">getNewStreamingNodeId</a></code></li>
<li><code><a title="edna.core.execution.context.StreamingContext.StreamingContext.logical_stream_graph" href="#edna.core.execution.context.StreamingContext.StreamingContext.logical_stream_graph">logical_stream_graph</a></code></li>
<li><code><a title="edna.core.execution.context.StreamingContext.StreamingContext.physical_graph" href="#edna.core.execution.context.StreamingContext.StreamingContext.physical_graph">physical_graph</a></code></li>
<li><code><a title="edna.core.execution.context.StreamingContext.StreamingContext.physical_node_id" href="#edna.core.execution.context.StreamingContext.StreamingContext.physical_node_id">physical_node_id</a></code></li>
<li><code><a title="edna.core.execution.context.StreamingContext.StreamingContext.run" href="#edna.core.execution.context.StreamingContext.StreamingContext.run">run</a></code></li>
<li><code><a title="edna.core.execution.context.StreamingContext.StreamingContext.stream_collection" href="#edna.core.execution.context.StreamingContext.StreamingContext.stream_collection">stream_collection</a></code></li>
<li><code><a title="edna.core.execution.context.StreamingContext.StreamingContext.stream_graph" href="#edna.core.execution.context.StreamingContext.StreamingContext.stream_graph">stream_graph</a></code></li>
<li><code><a title="edna.core.execution.context.StreamingContext.StreamingContext.streaming_node_id" href="#edna.core.execution.context.StreamingContext.StreamingContext.streaming_node_id">streaming_node_id</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.1</a>.</p>
</footer>
</body>
</html>